<section class="start_wrapper certificate-add-form">
  <div class="hpanel">
    <div class="panel-heading clearfix">
      <div class="pull-left">
        <h3>{{'add_achievement' | translate}} <span matTooltip="{{'phi_add_achievement' | translate}}"
            class="headTooltip"><i class="material-icons"> help_outline</i></span></h3>
      </div>
      <div class="pull-right">
        <button id="back_to_achievement" mat-mdc-button (click)="redirectToPreviousPage()">
          <i class="fa fa-hand-o-left fa-1x" style="font-size:20px;"></i> {{'back_to_achievement' | translate}}</button>
      </div>
    </div>
    <div class="panel-body">
      <div class="">
        <div class="add-student-form">
          <mat-horizontal-stepper class="form-horizontal" linear #stepper [selectedIndex]="tabselection">
            <mat-step [stepControl]="firstFormGroup">
              <form [formGroup]="firstFormGroup">
                <ng-template matStepLabel>
                  <span class="arrow">
                    <i class="fa fa-check"></i>
                  </span>
                  <span class="not-arrow"></span>
                  <p>{{'step' | translate}} 1</p>
                </ng-template>

                <div class="col-sm-12">
                  <div class="panel-body search_container">
                    <div class="pull-left col-lg-4 col-md-6 col-sm-12">
                      <div class="form-group">
                        <label class="control-label" for="status">
                          <h4>{{'courses' | translate}}
                            <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                              matTooltip="{{'ache_course_select' | translate}}" [matTooltipPosition]="position.value">
                              <i class="fa fa-info-circle"></i>
                            </span>
                          </h4>
                        </label>
                      </div>
                    </div>

                    <div class="pull-right col-lg-8 col-md-6 col-sm-12">
                      <form [formGroup]="onSearchCertCourse">
                        <div class="">
                          <div class="col-lg-8 col-md-6 col-sm-12">
                            <!-- <mat-form-field appearance="outline">
                              <mat-label>{{'search' | translate}}</mat-label>
                              <input matInput formControlName="searchCertCourse"
                                class="form-control acheivement-search">
                            </mat-form-field> -->
                            <mat-form-field appearance="outline" class="autocomplete">
                              <input formControlName="searchCertCourse" [(ngModel)]="certBadgeSearch"
                                [formControl]="certBadgeMycontrol" placeholder="{{'search' | translate}}" matInput
                                [matAutocomplete]="certBadge">
                              <mat-autocomplete #certBadge="matAutocomplete" [displayWith]="displayTitleFn">
                                <mat-option *ngFor="let certBagdeOption of certBadgeFilteredOptions | async"
                                  [value]="certBagdeOption">
                                  {{certBagdeOption.title}}
                                </mat-option>
                              </mat-autocomplete>
                            </mat-form-field>
                            <div class="text-danger text-left small" *ngIf="errorMsgSearchCC">
                              {{'enter_a_value' | translate}}</div>
                          </div>

                          <div class="col-lg-4 col-md-6 col-sm-12">
                            <div class="group-block">
                              <button mat-mdc-button class="group-btn"
                                (click)="onSearchCourse(onSearchCertCourse.value)">{{'go' | translate}}</button>
                              <button mat-mdc-button class="group-btn"
                                (click)="resetSearchCourse()">{{'reset' | translate}}</button>
                            </div>
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>


                  <mat-radio-group formControlName="course" (click)='courseSelection($event)'>
                    <div *ngIf="filterCourse && filterCourse.length > 0" class="search-results-course" infiniteScroll
                      [infiniteScrollDistance]="course_scrollDistance"
                      [infiniteScrollUpDistance]="course_scrollUpDistance" [infiniteScrollThrottle]="course_throttle"
                      [scrollWindow]="false" (scrolled)="onScrollDownCourse()">
                      <div class="col-md-3 col-sm-12" *ngFor="let course of filterCourse">
                        <div class="eng_group">
                          <div class="blockchain-main">
                            <mat-radio-button [value]="course.id" (click)='getcertificateId(course.id, "course")'
                              required>
                              <div class="badge-certificate-section">
                                <div class="blockchain-details">
                                  <img src="{{course.logo}}" class="img-responsive">
                                </div>
                                <div class="block-left">
                                  <h4>{{course.title}}</h4>
                                </div>
                                <div class="identifier_name"
                                  *ngIf="course.identifier && course.identifier != null && course.identifier != '' && course.identifier != 'None'">
                                  <p>{{course.identifier}}</p>
                                </div>
                              </div>
                            </mat-radio-button>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="filterCourse && filterCourse.length == 0" class="no-records">
                      {{ 'no_records_found' | translate }}
                    </div>
                  </mat-radio-group>
                </div>
                <!-- Related Certificate - Start -->
                <div *ngIf="relatedCert && relatedCertLists.length > 0" class="col-sm-12">
                  <div class="panel-body">
                    <div class="pull-left">
                      <div class="form-group">
                        <label class="control-label" for="status">
                          <h4>{{ 'related_certificate' | translate }}
                            <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                              matTooltip="{{'related_cert_select' | translate}}" [matTooltipPosition]="position.value">
                              <i class="fa fa-info-circle"></i>
                            </span>
                          </h4>
                        </label>
                      </div>
                    </div>
                  </div>
                  <mat-radio-group formControlName="course" (click)='courseSelection($event, true)'>
                    <div class="col-md-3 col-sm-12" *ngFor="let relateCert of relatedCertLists">
                      <div class="eng_group">
                        <div class="blockchain-main">
                          <mat-radio-button [value]="relateCert.id" (click)='getrelatedcertId(relateCert.id)' required>
                            <div class="badge-certificate-section">
                              <div class="blockchain-details">
                                <img src="{{relateCert.logo}}" class="img-responsive">
                                <div class="block-left">
                                  <h4>{{relateCert.title}}</h4>
                                </div>
                                <div class="identifier_name"
                                  *ngIf="relateCert.identifier && relateCert.identifier != null && relateCert.identifier != '' && relateCert.identifier != 'None'">
                                  <p>{{relateCert.identifier}}</p>
                                </div>
                              </div>
                            </div>
                          </mat-radio-button>
                        </div>
                      </div>
                    </div>
                  </mat-radio-group>
                </div>
                <!-- Related Certificate - End -->
                <div class="col-sm-12">

                  <div class="panel-body">
                    <div class="pull-left">
                      <div class="form-group">
                        <label class="control-label" for="status">
                          <h4>{{'certificates' | translate}}
                            <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                              matTooltip="{{'ache_cert_select' | translate}}" [matTooltipPosition]="position.value">
                              <i class="fa fa-info-circle"></i>
                            </span>
                          </h4>
                        </label>
                      </div>
                    </div>
                  </div>

                  <div class="form-group">

                    <mat-radio-group formControlName="certificate" (click)='certiSelection($event)'>
                      <div *ngIf="filterCert && filterCert.length > 0" class="search-results" infiniteScroll
                        [infiniteScrollDistance]="scrollDistance" [infiniteScrollUpDistance]="scrollUpDistance"
                        [infiniteScrollThrottle]="throttle" [scrollWindow]="false" (scrolled)="onScrollDownCert()">
                        <div class="col-md-3 col-sm-12" *ngFor="let certificate of filterCert">
                          <div class="eng_group">
                            <div class="blockchain-main">
                              <mat-radio-button [value]="certificate.id"
                                (click)='getcertificateId(certificate.id, "cert")' required>
                                <div class="badge-certificate-section">
                                  <div class="blockchain-details">
                                    <img src="{{certificate.logo}}" class="img-responsive">
                                    <div class="block-left">
                                      <h4>{{certificate.title}}</h4>
                                    </div>

                                    <div class="identifier_name"
                                      *ngIf="certificate.identifier && certificate.identifier != null && certificate.identifier != '' && certificate.identifier != 'None'">
                                      <p>{{certificate.identifier}}</p>
                                    </div>
                                  </div>
                                </div>
                              </mat-radio-button>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div *ngIf="filterCert && filterCert.length == 0" class="no-records">
                        {{ 'no_records_found' | translate }}
                      </div>
                    </mat-radio-group>
                  </div>
                </div>
                <div class="col-sm-12">
                  <div class="alert alert-danger" *ngIf="submitted"> {{'valid_inputs' | translate}} </div>
                  <button type="submit" mat-mdc-button matStepperNext class="step-next backtostep2redirect"
                    [disabled]="disableFirstNext"
                    (click)="submitted = firstFormGroup.invalid;">{{'next' | translate}}</button>
                </div>
              </form>
            </mat-step>

            <mat-step [stepControl]="secondFormGroup">
              <form [formGroup]="secondFormGroup">
                <ng-template matStepLabel>
                  <span class="arrow">
                    <i class="fa fa-check"></i>
                  </span>
                  <span class="not-arrow"></span>
                  <p>{{'step' | translate}} 2</p>
                </ng-template>

                <div class="col-sm-12">

                  <div class="panel-body clearfix">
                    <div class="pull-left">
                      <label class="control-label" for="status">
                        <h4>{{'students' | translate}}
                          <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                            matTooltip="{{'student_selection' | translate}}" [matTooltipPosition]="position.value">
                            <i class="fa fa-info-circle"></i>
                          </span>
                        </h4>
                      </label>
                    </div>

                    <div class="pull-right">
                      <form [formGroup]="searchStudForm">
                        <ul class="search-box">
                          <li>
                            <mat-form-field appearance="outline" class="autocomplete search_autocomplete">
                              <input formControlName="student_name" [(ngModel)]="studentNameSearch"
                                [formControl]="studentNameMycontrol" placeholder="{{'search' | translate}}" matInput
                                [matAutocomplete]="studentName">
                              <mat-autocomplete #studentName="matAutocomplete" [displayWith]="displayStudentNameFn">
                                <mat-option *ngFor="let studOption of studentNameFilteredOptions | async"
                                  [value]="studOption">
                                  {{studOption.name}}
                                </mat-option>
                              </mat-autocomplete>
                            </mat-form-field>
                          </li>

                          <li><button type="button" mat-mdc-button class="group-btn" [disabled]="isLoadingStudSearch"
                              (click)="onSearchStud(searchStudForm.value, 'search')"><i
                                class="material-icons">search</i></button></li>
                        </ul>
                      </form>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-lg-2 col-md-2 col-sm-12">
                      <form [formGroup]="searchStudIndiv">
                        <div class="group-block">
                          <div class="select-all">
                            <mat-checkbox formControlName="stud_search_input" class="check selectAllCheckBox"
                              (change)="onChangeSelectAll($event.checked)" labelPosition="after" [checked]="allselect">
                              {{'select_all' | translate}}<span
                                *ngIf="searchStudIndiv.controls['stud_search_input'].value || selectedStudent.length > 0">{{'- (' + selectedStudent.length + ')'}}</span>
                            </mat-checkbox>
                          </div>
                        </div>
                      </form>
                    </div>

                    <div class="col-lg-10 col-md-10 col-sm-12">
                      <form [formGroup]="searchGroupStud">
                        <div class="">
                          <div class="col-lg-8 col-md-6 col-sm-12">
                            <!-- <mat-form-field appearance="outline">
                              <mat-label>{{'group' | translate}}</mat-label>
                              <input matInput (input)="assignGroupName($event.target.value)"
                                formControlName="group_name" class="form-control acheivement-search">
                            </mat-form-field> -->

                            <mat-form-field appearance="outline" class="autocomplete">
                              <input (input)="getinputgroupname($event.target.value)" formControlName="group_name"
                                [(ngModel)]="search" [formControl]="myControl" placeholder="{{'group' | translate}}"
                                matInput [matAutocomplete]="auto">
                              <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
                                <mat-option *ngFor="let group_option of filteredOptions | async" [value]="group_option">
                                  {{group_option.group_name}}
                                </mat-option>
                              </mat-autocomplete>
                            </mat-form-field>
                          </div>



                          <div class="col-lg-4 col-md-6 col-sm-12">
                            <div class="group-block">
                              <button type="button" mat-mdc-button class="group-btn" [disabled]="isLoadingStudSearch"
                                (click)="addGroupForm(searchGroupStud.value)">{{'go'
                                | translate}}</button>
                              <button type="button" mat-mdc-button class="group-btn" [disabled]="isLoadingStudSearch"
                                (click)="resetGroupForm()">{{'reset'
                                | translate}}</button>
                            </div>
                          </div>
                        </div>
                      </form>
                    </div>

                  </div>


                  <div class="form-group" *ngIf="filterStudent && filterStudent.length > 0">
                    <div class="search-results-stud" infiniteScroll [infiniteScrollDistance]="stud_scrollDistance"
                      infiniteScrollUpDistance='stud_scrollUpDistance' [infiniteScrollThrottle]="stud_throttle"
                      [scrollWindow]="false" (scrolled)="onScrollDownStud()">
                      <div class="col-md-6 col-sm-12" *ngFor="let student of filterStudent; let i = index">
                        <div class="student-name-block">

                          <div class="blockchain-main">
                            <mat-checkbox class="check" (change)="onChangeStudent(student.id, $event.checked)"
                              labelPosition="after" [checked]="student.selected">
                              <ul class="student-details">
                                <li><img class="img-responsive" style="max-width:auto;object-fit:contain;height:50px;"
                                    [src]="(student.avatar)? student.avatar : 'assets/images/avatar.jpeg'"></li>
                                <li>
                                  <div class="student-name">
                                    <p>{{student.first_name}} {{student.last_name}}</p>
                                  </div>
                                </li>
                              </ul>
                            </mat-checkbox>
                          </div>

                        </div>
                      </div>
                    </div>
                  </div>
                  <div *ngIf="filterStudent && filterStudent.length == 0" class="no-records">
                    {{ 'no_records_found' | translate }}
                  </div>
                </div>

                <ngx-smart-modal #relatedCertPopup identifier="relatedCertPopup" class="relatedCertPopup"
                  closable='false' escapable='false' dismissable="false">
                  <!-- Related Certificate - Start -->
                  <div *ngIf="relatedCert && relatedCertLists.length > 0" class="col-sm-12">
                    <div class="panel-body">
                      <div class="pull-left">
                        <div class="form-group">
                          <label class="control-label" for="status">
                            <h4>{{ 'related_certificate' | translate }}
                              <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                                matTooltip="{{'related_cert_select' | translate}}"
                                [matTooltipPosition]="position.value">
                                <i class="fa fa-info-circle"></i>
                              </span>
                            </h4>
                          </label>
                        </div>
                      </div>
                    </div>
                    <mat-radio-group formControlName="course" (click)='courseSelection($event, true)'>
                      <div class="related-certificate">
                        <div class="col-md-3 col-sm-12" *ngFor="let relateCert of relatedCertLists">
                          <div class="eng_group">
                            <div class="blockchain-main">
                              <mat-radio-button [value]="relateCert.id" (click)='getrelatedcertId(relateCert.id)'
                                required>
                                <div class="badge-certificate-section">
                                  <div class="blockchain-details">
                                    <img src="{{relateCert.logo}}" class="img-responsive">
                                    <div class="block-left">
                                      <h4>{{relateCert.title}}</h4>
                                    </div>

                                    <div class="identifier_name"
                                      *ngIf="relateCert.identifier && relateCert.identifier != null && relateCert.identifier != '' && relateCert.identifier != 'None'">
                                      <p>{{relateCert.identifier}}</p>
                                    </div>
                                  </div>
                                </div>
                              </mat-radio-button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </mat-radio-group>
                    <div class="selected_certificate">
                      <h4 class="control-label">*{{'info_about_relate_cert_selection' | translate}}</h4>
                    </div>
                    <button mat-mdc-button class="step-back"
                      (click)="ngxSmartModalService.getModal('relatedCertPopup').close();">{{'ok' | translate}}</button>
                  </div>
                </ngx-smart-modal>

                <div class="col-sm-12">
                  <div class="step-buttons">
                    <div class="alert alert-danger" *ngIf="submitted"> {{'valid_inputs' | translate}} </div>
                    <button mat-mdc-button matStepperPrevious class="step-back"
                      (click)="submitted = firstFormGroup.invalid; onStep2Back();">{{'back'
                      | translate}}</button>
                    <button mat-mdc-button matStepperNext class="step-next" [disabled]="disablestep2button"
                      (click)="submitted = secondFormGroup.invalid">{{'next'
                      | translate}}</button>
                  </div>
                </div>
              </form>
            </mat-step>

            <mat-step [stepControl]="threeFormGroup">
              <form [formGroup]="threeFormGroup">
                <ng-template matStepLabel>
                  <span class="arrow">
                    <i class="fa fa-check"></i>
                  </span>
                  <span class="not-arrow"></span>
                  <p>{{'step' | translate}} 3</p>
                </ng-template>
                <div class="col-sm-12">
                  <fieldset>
                    <div *ngIf="selectedStudent && selectedStudent.length > 0"
                      class="search-results-stud student-result-list">
                      <div class="col-md-6 col-sm-12" *ngFor="let student of selectedStudent; let i = index">
                        <div class="student-name-block">

                          <div class="blockchain-main">
                            <mat-checkbox class="check" (change)="onChangeStudent(student.id, $event.checked, true)"
                              labelPosition="after" [checked]=student.selected>
                              <ul class="student-details">
                                <li><img class="img-responsive" style="max-width:auto;object-fit:contain;height:50px;"
                                    [src]="(student.avatar)? student.avatar : 'assets/images/avatar.jpeg'"></li>
                                <li>
                                  <div class="student-name">
                                    <p>{{student.first_name}} {{student.last_name}}</p>
                                  </div>
                                </li>
                              </ul>
                            </mat-checkbox>
                          </div>

                        </div>
                      </div>
                    </div>
                  </fieldset>
                </div>
                <div class="col-sm-6">
                  <div class="form-group">
                    <label class="control-label" for="issue_date">{{'issue_date' | translate}}
                      <span class="mandatory">*</span>
                      <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                        matTooltip="{{'pick_date_issue' | translate}}" [matTooltipPosition]="position.value">
                        <i class="fa fa-info-circle"></i>
                      </span>
                    </label>
                    <div>
                      <mat-form-field class="angular-datepicker">
                        <input matInput [placeholder]="apiService.cus_data === 1 ? 'mm/dd/yyyy' : 'dd/mm/yyyy'" [readonly]="true" [matDatepicker]="issueDate"
                          (click)="issueDate.open()" formControlName="issue_date" id="issue_date"
                          (dateChange)="onStartDateChange($event.value);changeDateEvent($event);">
                        <mat-datepicker-toggle matSuffix [for]="issueDate"></mat-datepicker-toggle>
                        <mat-datepicker #issueDate disabled="false"></mat-datepicker>
                      </mat-form-field>
                      <div class="refresh-icon" (click)="refreshIssueDate(1)">
                        <mat-icon>refresh</mat-icon>
                      </div>
                      <div class="text-danger text-left small" *ngIf="errorMsg">{{geterrorMsg('issue_date') ||
                        this.errorMsgArr['issue_date'] | translate}}</div>
                    </div>
                  </div>
                </div>

                <div class="col-sm-6">
                  <div class="form-group">
                    <label class="control-label" for="end_validity">{{'expire_date' | translate}}
                      <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                        matTooltip="{{'pick_date_expire' | translate}}" [matTooltipPosition]="position.value">
                        <i class="fa fa-info-circle"></i>
                      </span>
                    </label>

                    <div>
                      <mat-form-field class="angular-datepicker">
                        <input matInput [placeholder]="apiService.cus_data === 1 ? 'mm/dd/yyyy' : 'dd/mm/yyyy'" [readonly]="true" [matDatepicker]="endValidity"
                          (click)="endValidity.open()" min={{minendDate}} formControlName="end_validity"
                          id="end_validity" (dateChange)="changeendDateEvent($event);">
                        <mat-datepicker-toggle matSuffix [for]="endValidity"></mat-datepicker-toggle>
                        <mat-datepicker #endValidity disabled="false"></mat-datepicker>
                      </mat-form-field>
                      <div class="refresh-icon" (click)="refreshIssueDate(2)">
                        <mat-icon>refresh</mat-icon>
                      </div>
                      <div class="text-danger text-left small" *ngIf="errorMsg">{{geterrorMsg('end_validity') ||
                        this.errorMsgArr['end_validity'] | translate}}</div>
                    </div>
                  </div>

                  <div class="form-group" *ngIf="threeFormGroup.controls['end_validity'].value">
                    <label class="control-label" for="expiry_actions">{{'action_on_expire' | translate}}
                      <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                        matTooltip="{{'action_expire_day' | translate}}" [matTooltipPosition]="position.value">
                        <i class="fa fa-info-circle"></i>
                      </span>
                    </label>
                    <select class="form-control" formControlName="expiry_actions">
                      <option [value]="null" [selected]="true" [disabled]="true">{{'select' | translate}} {{'actions' |
                        translate}}</option>
                      <option *ngFor="let action of expireAction" [value]="action.id">
                        {{action.text | translate}}
                      </option>
                    </select>
                    <div class="text-danger text-left small" *ngIf="errorMsg">{{geterrorMsg('certificate') ||
                      this.errorMsgArr['certificate'] | translate}}</div>
                  </div>

                  <div class="form-group" *ngIf="threeFormGroup.controls['expiry_actions'].value === '4'">
                    <label class="control-label" for="barcode" style="width:100%;">{{'email' | translate}}
                      <span style="font-size:10px;margin:0px 2px;color: #3498db; float: right;">({{'note' |
                        translate}}: {{'please_enter_emails_seperated_by_comma' | translate}})</span>
                    </label>
                    <input type="text" formControlName="expiry_text" [readOnly]="mode === 'view'" class="form-control"
                      placeholder="{{'email' | translate}}" value={{displaySelectedStudString}}>
                    <div class="text-danger text-left small" *ngIf="errorMsg">{{geterrorMsg('barcode') ||
                      errorMsgArr['barcode'] | translate}}</div>
                  </div>
                </div>

                <div class="col-sm-6">
                  <div class="form-group">
                    <label class="control-label" for="start_date">{{'start_date' | translate}}
                      <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                        matTooltip="{{'pick_date_start' | translate}}" [matTooltipPosition]="position.value">
                        <i class="fa fa-info-circle"></i>
                      </span>
                    </label>

                    <div>
                      <mat-form-field class="angular-datepicker">
                        <input matInput [placeholder]="apiService.cus_data === 1 ? 'mm/dd/yyyy' : 'dd/mm/yyyy'" [readonly]="true" [matDatepicker]="startDate"
                          (click)="startDate.open()" formControlName="start_date"
                          (dateChange)="changeStartDateEvent($event);">
                        <mat-datepicker-toggle matSuffix [for]="startDate"></mat-datepicker-toggle>
                        <mat-datepicker #startDate disabled="false"></mat-datepicker>
                      </mat-form-field>
                      <div class="refresh-icon" (click)="refreshIssueDate(3)">
                        <mat-icon>refresh</mat-icon>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-sm-6">
                  <div class="form-group">
                    <label class="control-label" for="issue_date">{{'end_date' | translate}}
                      <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                        matTooltip="{{'pick_date_end' | translate}}" [matTooltipPosition]="position.value">
                        <i class="fa fa-info-circle"></i>
                      </span>
                    </label>

                    <div>
                      <mat-form-field class="angular-datepicker">
                        <input matInput [placeholder]="apiService.cus_data === 1 ? 'mm/dd/yyyy' : 'dd/mm/yyyy'" [readonly]="true" [matDatepicker]="endDate"
                          (click)="endDate.open()" formControlName="end_date"
                          (dateChange)="changeEndDateEvent($event);">
                        <mat-datepicker-toggle matSuffix [for]="endDate"></mat-datepicker-toggle>
                        <mat-datepicker #endDate disabled="false"></mat-datepicker>
                      </mat-form-field>
                      <div class="refresh-icon" (click)="refreshIssueDate(4)">
                        <mat-icon>refresh</mat-icon>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-sm-6">
                  <div class="form-group">
                    <label class="control-label" for="title">{{'achiv_cert_num' | translate}}
                      <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                        matTooltip="{{'select_certificate_number' | translate}}" [matTooltipPosition]="position.value">
                        <i class="fa fa-info-circle"></i>
                      </span>
                    </label>
                    <input type="text" class="form-control" formControlName="certificate_number">
                  </div>
                </div>


                <div class="col-sm-6">
                  <div class="form-group">
                    <label class="control-label" for="share">{{'select_mail_content' | translate}} <span
                        class="mandatory">*</span>
                      <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                        matTooltip="{{'select_mail_content_info' | translate}}" [matTooltipPosition]="position.value">
                        <i class="fa fa-info-circle"></i>
                      </span>
                    </label>
                    <div class="form-group share-radio select_field">
                      <select formControlName="achievement_mail_id" class="form-control">
                        <option [disabled]="true" [value]="null">{{'select_mail_content' | translate}}</option>
                        <option *ngFor="let opt of cannedDatas" [value]="opt?.id">{{opt.title | translate}}
                        </option>
                      </select>
                    </div>
                    <div class="text-danger text-left small" *ngIf="errorMsg">{{geterrorMsg('achievement_mail_id') ||
                      errorMsgArr['achievement_mail_id'] | translate}}</div>
                  </div>
                </div>


                <div class="col-sm-6">
                  <div class="form-group">
                    <label class="control-label" for="title">{{'additional' | translate}}
                      <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                        matTooltip="{{'select_additional' | translate}}" [matTooltipPosition]="position.value">
                        <i class="fa fa-info-circle"></i>
                      </span>
                    </label>
                    <input type="text" class="form-control" formControlName="additional">
                  </div>
                </div>

                <div class="col-sm-12">
                  <div class="form-group border angular-editor">
                    <label class="control-label" for="testimonial">{{'testimonial' | translate}}
                      <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                        matTooltip="{{'enter_feedback' | translate}}" [matTooltipPosition]="position.value">
                        <i class="fa fa-info-circle"></i>
                      </span>
                    </label>
                    <angular-editor [placeholder]="'Insert text here...'" [config]="editorConfig"
                      [style]="{height: '100px'}" formControlName="testimonial" (focusin)="focusFunction()">
                    </angular-editor>
                  </div>
                </div>

                <div class="col-sm-12">
                  <div class="evidence_content">
                    <label class="control-label" for="evidence">{{'evidence' | translate}}
                      <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                        matTooltip="{{'multiple_evidence' | translate}}" [matTooltipPosition]="position.value">
                        <i class="fa fa-info-circle"></i>
                      </span>

                      <a (click)="addEvidence()" class="add-evidence-btn">
                        <i class="material-icons">add_circle</i>
                      </a>

                    </label>
                  </div>

                  <div formArrayName="evidence" class="evidence_content">
                    <div *ngFor="let child of threeFormGroup.controls.evidence['controls']; let i = index"
                      class="evidence-field">
                      <div *ngIf="i !== 0" formGroupName="{{i}}">
                        <div class="form-group border">
                          <div class="col-lg-6 col-md-6 col-sm-6" style="padding: 0px">
                            <input style="width:100%" type="text" class="form-control evidence-input"
                              placeholder="{{'evidence_link' | translate}}" formControlName="evid" />
                          </div>
                          <div class="col-lg-5 col-md-5 col-sm-5">
                            <input style="width:100%" type="text" class="form-control evidence-input"
                              formControlName="lable" placeholder="{{'evidence_label' | translate}}" />
                          </div>
                          <div class="col-lg-1 col-md-1 col-sm-1" style="padding: 0px">
                            <a class="evidence-delete" (click)="removeEvidence(i)">
                              <i class="material-icons">delete</i>
                            </a>
                          </div>
                          <div class="col-sm-12" style="padding: 0px"
                            *ngIf="errorMsg && threeFormGroup.controls.evidence['controls'][i]['controls']['evid'].hasError('pattern')">
                            <div class="text-danger text-left small">
                              {{'invalid_url' | translate}}
                            </div>
                            <br>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-sm-6">
                  <div class="form-group border">
                    <label class="control-label" for="share">{{'social_media_sharing' | translate}}
                      <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                        matTooltip="{{'social_media_sharing_info' | translate}}" [matTooltipPosition]="position.value">
                        <i class="fa fa-info-circle"></i>
                      </span>
                    </label>
                    <div class="form-group share-radio">
                      <mat-radio-group formControlName="social_media_sharing">
                        <mat-radio-button value='1' checked>{{'enable' | translate}}</mat-radio-button>
                        <mat-radio-button value='2'> {{'disable' | translate}}</mat-radio-button>
                      </mat-radio-group>
                    </div>
                  </div>
                </div>

                <!-- <div class="col-sm-6"
                  *ngIf="( testMode ) || ( walletDetails?.count?.remaining_wallet >= 1 && !testMode )">
                  <div class="form-group border">
                    <label class="control-label" for="share">{{'multiple_blockchain' | translate}} <span
                        class="mandatory">*</span>
                      <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                        matTooltip="{{'multiple_blockchain_info' | translate}}" [matTooltipPosition]="position.value">
                        <i class="fa fa-info-circle"></i>
                      </span>
                    </label>
                    <div class="form-group share-radio">
                      <select formControlName="blockchain_key" class="form-control"
                        (change)="findTestBlockchain($event.target.value)">
                        <option [disabled]="true" [value]="null">{{'select_blockchain' | translate}}</option>
                        <option *ngFor="let opt of blockchainList" [value]="opt?.key_number"
                          [selected]="opt?.key_number == defaultBlockchainVal?.key_number">{{opt.key | translate}}
                        </option>
                      </select>
                    </div>
                    <div class="text-danger text-left small" *ngIf="errorMsg">{{geterrorMsg('blockchain_key') ||
                      errorMsgArr['blockchain_key'] | translate}}</div>
                  </div>
                </div> -->




                <div class="col-sm-12">
                  <div class="alert alert-danger bottom_message" *ngIf="errorMsg">
                    {{errorMsg | translate}}
                  </div>
                  <br>
                </div>
                <div class="col-sm-12">
                  <div class="form-group new_assign_btn">
                    <button *ngIf="process" class="btn btn-primary">{{processingtxt | translate}}</button>
                    <button *ngIf="!process" mat-mdc-button matStepperPrevious class="step-back backtostep2 pull-left"
                      (click)="submitted = secondFormGroup.invalid;backtostep2Select();">{{'back' | translate}}</button>
                    <button [disabled]="disablestep2button"
                      *ngIf="walletDetails?.count?.remaining_wallet >= 10"
                      type="click" mat-mdc-button class="btn btn-form-save btn_center"
                      (click)="submitted = threeFormGroup.invalid; confirmationPost(threeFormGroup.value, true)"
                      matTooltip="{{'post_to_blockchain' | translate}}">{{'post_to_blockchain' | translate}}</button>
                    <button [disabled]="disablestep2button"
                      *ngIf="!isSelectCert && walletDetails?.count?.remaining_wallet >= 1"
                      style="background-color: gray;" type="click" mat-mdc-button class="btn btn-form-save  pull-right"
                      (click)="submitted = threeFormGroup.invalid; submitAssignForm(threeFormGroup.value, false)"
                      matTooltip="{{'post_digital_credential' | translate}}">{{'post_digital_credential' | translate}}</button>
                  </div>
                </div>
              </form>
            </mat-step>
          </mat-horizontal-stepper>
        </div>
      </div>
    </div>
    <!-- <div *ngIf="process" class="loader-container">
      <mat-spinner diameter="40"></mat-spinner>
      <p *ngIf="waitMessage">{{ waitMessage }}</p>
    </div> -->
    <ngx-smart-modal #loadingModal identifier="loadingModal" class="loadingModal" [closable]='false' 
    [escapable]='false' [dismissable]='false'>
      <div class="process-message">
        <mat-spinner diameter="40"></mat-spinner>
        <p>
          {{waitMessage | translate}}
        </p>
      </div>
    </ngx-smart-modal>
    <ngx-smart-modal #errorMultiUpload identifier="errorMultiUpload" class="errorMultiUpload" [closable]='false'
      [escapable]='false' [dismissable]='false'>

      <p>{{'total_no_of_cert_added' | translate}} : {{responseData.in_count}}</p>
      <p>{{'no_of_cert_added' | translate}} : {{responseData.out_count}}</p>
      <p>{{'no_of_cert_not_added' | translate}} : {{responseData.fail_count}}</p>
      <div *ngIf="responseData.status !== 'Completed'" class="failed-message">
        <i class="material-icons"> report_problem </i>
        <div class="report-list">
          <div *ngFor="let msg of responseData.error_detail; let i = index">
            <h4>{{msg[0] | translate}}</h4>
            <ul class="report-email">
              <li *ngFor="let email of msg[1]">
                {{email}}
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="button-container">
        <button mat-mdc-button class="back go-dash" routerLink="/issuecertificate"
          (click)="ngxSmartModalService.getModal('errorMultiUpload').close()">{{'go_to_cert_list' | translate}}</button>
      </div>
    </ngx-smart-modal>
    <ngx-smart-modal #successMultiUpload identifier="successMultiUpload" class="errorMultiUpload" [closable]='false'
      [escapable]='false' [dismissable]='false'>
      <div *ngIf="responseData.status === 'Completed'" class="success-message">
        <i class="material-icons">check_circle</i>
        <div class="report-list">
          <div>
            <div class="success-title">
              <h4>{{responseData.msg | translate}}</h4>
            </div>

            <table class="success-table">
              <tr>
                <td>{{'total_no_of_cert_added' | translate}}</td>
                <td>:</td>
                <td>{{responseData.in_count}}</td>
              </tr>

              <tr>
                <td>{{'no_of_cert_added' | translate}}</td>
                <td>:</td>
                <td>{{responseData.out_count}}</td>
              </tr>

              <tr>
                <td>{{'no_of_cert_not_added' | translate}}</td>
                <td>:</td>
                <td>{{responseData.fail_count}}</td>
              </tr>
            </table>

          </div>
        </div>
      </div>
      <div class="button-container">
        <button mat-mdc-button class="back go-dash" routerLink="/issuecertificate"
          (click)="ngxSmartModalService.getModal('errorMultiUpload').close()">{{'go_to_cert_list' | translate}}</button>
      </div>
    </ngx-smart-modal>
  </div>

  <app-commonplanalert></app-commonplanalert>
  <app-user-verify-popup></app-user-verify-popup>

</section>
