<section class="start_wrapper">
  <div class="hpanel">
    <div class="panel-heading clearfix">
      <div class="pull-left">
        <h3 *ngIf="apiService.userType !== '3'">{{'team' | translate}} <span
            matTooltip="{{'phi_team_add_edit' | translate}}" class="headTooltip"><i class="material-icons">
              help_outline</i></span></h3>
      </div>
      <div class="pull-right">
        <div class="form-group">
          <button *ngIf="apiService.userType !== '3'" id="back_to_team" mat-mdc-button class="add-course-btn"
            routerLink="/teamlist">
            <i class="fa fa-hand-o-left fa-1x" style="font-size:20px;"></i>
            {{'back_to_team' | translate}}
          </button>
        </div>
      </div>
    </div>

    <div class="panel-body">
      <div class="add-student-form add-team">
        <div class="row">
          <div class="col-sm-12">
            <div class="alert alert-success" *ngIf="successMsg">
              {{successMsg}}
            </div>
            <br>
          </div>
          <form class="form-horizontal" [formGroup]="teamMemberForm" (ngSubmit)="submitForm(teamMemberForm.value)">

            <div class="col-sm-6">
              <div class="form-group">
                <label class="control-label" for="name">{{'first_name' | translate}}
                  <span class="mandatory">*</span>
                </label>
                <input type="text" class="form-control" formControlName="first_name"
                  placeholder="{{'first_name' | translate}}">
                <div class="text-danger text-left small" *ngIf="errorMsg">
                  {{getErrorMsg('first_name') || errorMsgArr['first_name'] | translate}}</div>
              </div>
            </div>

            <div class="col-sm-6">
              <div class="form-group">
                <label class="control-label" for="name">{{'last_name' | translate}}
                  <span class="mandatory">*</span>
                </label>
                <input type="text" class="form-control" formControlName="last_name"
                  placeholder="{{'last_name' | translate}}">
                <div class="text-danger text-left small" *ngIf="errorMsg">
                  {{getErrorMsg('last_name') || errorMsgArr['last_name'] | translate}}</div>
              </div>
            </div>

            <div class="col-sm-6">
              <div class="form-group">
                <label class="control-label" for="email">{{'email' | translate}}
                  <span class="mandatory">*</span>
                </label>
                <input type="text" class="form-control" formControlName="email" placeholder="{{'email' | translate}}">
                <div class="text-danger text-left small" *ngIf="errorMsg">
                  {{getErrorMsg('email') || errorMsgArr['email'] | translate}}</div>
              </div>
            </div>

            <div class="col-sm-6">
              <div class="form-group">
                <label class="control-label" for="phone">{{'phone_number' | translate}}</label>
                <input type="text" class="form-control" formControlName="phone"
                  placeholder="{{'phone_number' | translate}}">
                <div class="text-danger text-left small" *ngIf="errorMsg">
                  {{getErrorMsg('phone') || errorMsgArr['phone'] | translate}}</div>
              </div>
            </div>

            <div class="col-sm-6">
              <div class="form-group">
                <label class="control-label" for="role">{{'role' | translate}}</label>
                <input type="text" class="form-control" formControlName="custom_template"
                  placeholder="{{'role' | translate}}">
                <div class="text-danger text-left small" *ngIf="errorMsg">
                  {{getErrorMsg('custom_template') || errorMsgArr['custom_template'] | translate}}</div>
              </div>
            </div>

            <div class="col-md-12 col-sm-12">
              <div class="form-group">
                <label class="control-label" for="phone">{{'access_menu' | translate}}
                  <span *ngIf="access_notify" class="access_notify_label">*{{'select_atleast_one' | translate}}</span>
                </label>

                <ul class="access-menu">
                  <div *ngIf="!teamMemberForm.controls['admin_prv'].value">
                    <!-- <li>
                      <mat-checkbox id='menupriviliage_3' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="dashboard">{{'dashboard' | translate}}</mat-checkbox>
                    </li> -->
                    <li>
                      <mat-checkbox id='menupriviliage_1' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="students">
                        <span> {{'students' | translate}} </span>
                      </mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_2' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="certificate">{{'certificates' | translate}}</mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_4' (change)="onSelectTeamCheck(1, $event.checked, 'act')"
                        formControlName="issue_certificate" #issueCheckbox
                        (change)="(!issueCheckbox.checked)? teamMemberForm.controls['blockchain_certificate'].setValue(false): teamMemberForm.controls['blockchain_certificate'].setValue(true)">
                        <span> {{'add_achievement' | translate}} </span>
                      </mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_11' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="marketing_tool_prv">
                        <span> {{'marketing_tools' | translate}} </span>
                      </mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_6' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="account_settings">{{'account_settings' | translate}}</mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_7' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="change_password">{{'change_password' | translate}}</mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_8' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="allow_search">{{'achiments_search' | translate}}</mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_9' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="course">{{'courses' | translate}}</mat-checkbox>
                    </li>
                  </div>
                  <li>
                    <mat-checkbox id='menupriviliage_10' (change)="adminSelect();" formControlName="admin_prv">
                      {{'admin' | translate}}</mat-checkbox>
                  </li>
                  <div *ngIf="teamMemberForm.controls['admin_prv'].value">
                    <!-- <li>
                      <mat-checkbox id='menupriviliage_3' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="dashboard">{{'dashboard' | translate}}</mat-checkbox>
                    </li> -->
                    <li>
                      <mat-checkbox id='menupriviliage_1' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="students">
                        <span> {{'students' | translate}} </span>
                      </mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_2' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="certificate">{{'certificates' | translate}}</mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_4' (change)="onSelectTeamCheck(1, $event.checked, 'act')"
                        formControlName="issue_certificate" #issueCheckbox
                        (change)="(!issueCheckbox.checked)? teamMemberForm.controls['blockchain_certificate'].setValue(false): teamMemberForm.controls['blockchain_certificate'].setValue(true)">
                        <span> {{'add_achievement' | translate}} </span>
                      </mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_6' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="account_settings">{{'account_settings' | translate}}</mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_7' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="change_password">{{'change_password' | translate}}</mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_8' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="allow_search">{{'achiments_search' | translate}}</mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_9' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="course">{{'courses' | translate}}</mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_11' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="logs_prv">{{'logs' | translate}}</mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_12' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="teammembers_prv">{{'team_members' | translate}}</mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_13' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="cannedmessage_prv">{{'canned_message' | translate}}</mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_16' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="marketing_tool_prv">{{'marketing_tools' | translate}}</mat-checkbox>
                    </li>
                    <li *ngIf="apiService.user.profile_details.allow_api">
                      <mat-checkbox id='menupriviliage_14' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="api_prv">{{'api' | translate}}</mat-checkbox>
                    </li>
                    <li>
                      <mat-checkbox id='menupriviliage_15' (change)="onSelectTeamCheck(1, $event.checked)"
                        formControlName="bouncedmail_prv">{{'mandril' | translate}}</mat-checkbox>
                    </li>
                  </div>
                </ul>
              </div>
            </div>

            <div class="col-sm-6">
              <div class="form-group">
                <label class="control-label" for="status">{{'status' | translate}}</label>
                <div class="">
                  <mat-radio-group [(ngModel)]="teamModel.is_active" formControlName="is_active">
                    <mat-radio-button class="example-radio-button" *ngFor="let statuslist of statuslists"
                      [value]="statuslist.value">
                      {{statuslist.text | translate}}
                    </mat-radio-button>
                  </mat-radio-group>
                </div>
              </div>
            </div>

            <div class="col-sm-6" *ngIf="memberId == null">
              <div>
                <label class="control-label" for="share">{{'select_mail_content' | translate}} <span
                    class="mandatory">*</span>
                  <span class="tooltip-view" #tooltip="matTooltip" matTooltipClass="example-tooltip-red"
                    matTooltip="{{'select_mail_content_info' | translate}}">
                    <i class="fa fa-info-circle"></i>
                  </span>
                </label>
                <div class="form-group share-radio">
                  <select formControlName="team_member_mail_id" class="form-control">
                    <option [disabled]="true" [value]="null">{{'select_mail_content' | translate}}</option>
                    <option *ngFor="let opt of cannedDatas" [value]="opt?.id">{{opt.title | translate}}
                    </option>
                  </select>
                  <div class="text-danger text-left small" *ngIf="errorMsg">{{getErrorMsg('team_member_mail_id') ||
                        errorMsgArr['team_member_mail_id'] | translate}}</div>
                </div>
              </div>
            </div>

            <div class="col-sm-12">
              <div class="alert alert-danger" *ngIf="errorMsg">
                {{errorMsg | translate}}
              </div>
              <br>
            </div>
            <div class="col-sm-12">
              <div class="form-group">
                <button *ngIf="process" class="btn btn-primary">{{'processing' | translate}}...</button>
                <button *ngIf="!process" [disabled]="disablebutton" mat-mdc-button
                  class="btn btn-form-save">{{'save_button' | translate}}</button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>

<ngx-smart-modal #myModal identifier="myModal" closable='false'
    escapable='false' dismissable="false"
  (onAnyCloseEvent)="ngxSmartModalService.resetModalData('myModal')">

  <div class="add-select-title">
    <h4>{{'add_select_drop_down' | translate}}</h4>
  </div>

  <div class="add-select-field">
    <div class="row">
      <div class="col-md-8 col-sm-12">
        <input type="text" class="form-control" #optionval placeholder="{{'enter_option' | translate}}"
          (keyup.enter)="addOptionsValues(myModal.getData().selectedIndex, optionval.value)">
      </div>

      <div class="col-md-4 col-sm-12">
        <div class="add-opt">
          <a (click)="addOptionsValues(myModal.getData().selectedIndex, optionval.value)" mat-mdc-button
            href="javascript://" mat-mdc-button class="add_role">
            {{'add_options' | translate}} <i class="material-icons">add_circle</i>
          </a>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="teamMemberForm.controls['field_set'].value.length > 0" class="add-custom-section">
    <div
      *ngFor="let optionVal of teamMemberForm.controls['field_set']?.value[myModal.getData()?.selectedIndex]?.options; let j = index"
      class="evidence-field">

      <ul class="optional-list">
        <li><span>{{optionVal.key}}</span></li>

        <li>
          <a class="evidence-delete add-options" (click)="removeOptions(myModal.getData().selectedIndex, j)">
            <i class="material-icons">delete</i>
          </a>
        </li>
      </ul>

    </div>
  </div>

  <div class="dropdown-ok">
    <button type="button" mat-mdc-button class="add-custom-ok"
      (click)="ngxSmartModalService.getModal('myModal').close();">{{'ok' | translate}}</button>
  </div>
</ngx-smart-modal>



<div class="acheivement-popup detailModelBox">
  <ngx-smart-modal #showRole identifier="showRole" class="showRole">
    <div class="info-tooltip"><a (click)="ngxSmartModalService.getModal('tooltipShow').open()"><i
          class="material-icons"> info </i></a></div>

    <div class="tool-image">
      <img src="assets/images/activity-template.png" class="img-responsive">
    </div>
  </ngx-smart-modal>
</div>

<div class="acheivement-popup detailModelBox">
  <ngx-smart-modal #graphicShow identifier="graphicShow" class="graphicShow">
    <div class="info-tooltip"><a (click)="ngxSmartModalService.getModal('tooltipGraphic').open()"><i
          class="material-icons"> info </i></a></div>

    <div class="tool-image">
      <img src="assets/images/step-UI.png" class="img-responsive">
    </div>
  </ngx-smart-modal>
</div>





<ngx-smart-modal #tooltipGraphic identifier="tooltipGraphic" class="tooltipGraphic">
  <h4>{{'template_road_map_head' | translate}}</h4>
  <p>{{'template_road_map_info' | translate}}</p>
</ngx-smart-modal>

<ngx-smart-modal #tooltipShow identifier="tooltipShow" class="tooltipShow">
  <h4>{{'mobileview_center_layout_head' | translate}}</h4>
  <p>{{'mobileview_center_layout_info' | translate}}</p>
</ngx-smart-modal>